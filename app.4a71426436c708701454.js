(()=>{"use strict";(()=>{function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function s(e){return"function"==typeof e}function r(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function i(e){return 0===Object.keys(e).length}function a(e,t){e.appendChild(t)}function c(e,t,n){e.insertBefore(t,n||null)}function l(e){e.parentNode.removeChild(e)}function u(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function d(e){return document.createElement(e)}function p(e){return document.createTextNode(e)}function f(){return p(" ")}function h(){return p("")}function y(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function m(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}let g;function $(e){g=e}new Set,new Set;const k=[],b=[],w=[],Q=[],_=Promise.resolve();let v=!1;function A(e){w.push(e)}let x=!1;const C=new Set;function N(){if(!x){x=!0;do{for(let e=0;e<k.length;e+=1){const t=k[e];$(t),M(t.$$)}for($(null),k.length=0;b.length;)b.pop()();for(let e=0;e<w.length;e+=1){const t=w[e];C.has(t)||(C.add(t),t())}w.length=0}while(k.length);for(;Q.length;)Q.pop()();v=!1,x=!1,C.clear()}}function M(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(A)}}const U=new Set;let q;function E(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function S(r,i,a,c,u,d,p=[-1]){const f=g;$(r);const h=r.$$={fragment:null,ctx:null,props:d,update:e,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:i.context||[]),callbacks:n(),dirty:p,skip_bound:!1};let y=!1;if(h.ctx=a?a(r,i.props||{},((e,t,...n)=>{const o=n.length?n[0]:t;return h.ctx&&u(h.ctx[e],h.ctx[e]=o)&&(!h.skip_bound&&h.bound[e]&&h.bound[e](o),y&&function(e,t){-1===e.$$.dirty[0]&&(k.push(e),v||(v=!0,_.then(N)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(r,e)),t})):[],h.update(),y=!0,o(h.before_update),h.fragment=!!c&&c(h.ctx),i.target){if(i.hydrate){const e=(w=i.target,Array.from(w.childNodes));h.fragment&&h.fragment.l(e),e.forEach(l)}else h.fragment&&h.fragment.c();i.intro&&((m=r.$$.fragment)&&m.i&&(U.delete(m),m.i(b))),function(e,n,r,i){const{fragment:a,on_mount:c,on_destroy:l,after_update:u}=e.$$;a&&a.m(n,r),i||A((()=>{const n=c.map(t).filter(s);l?l.push(...n):o(n),e.$$.on_mount=[]})),u.forEach(A)}(r,i.target,i.anchor,i.customElement),N()}var m,b,w;$(f)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(q=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(t).filter(s);for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}disconnectedCallback(){o(this.$$.on_disconnect)}$destroy(){E(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!i(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});class T{constructor(e){this.kosyClient=window.parent,this.kosyApp=e}startApp(){return new Promise(((e,t)=>{window.addEventListener("message",(t=>{let n=t.data;switch(n.type){case"receive-initial-info":e(n.payload);break;case"client-has-joined":this.kosyApp.onClientHasJoined(n.payload);break;case"client-has-left":this.kosyApp.onClientHasLeft(n.clientUuid);break;case"get-app-state":const t=this.kosyApp.onRequestState();this._sendMessageToKosy({type:"receive-app-state",payload:t,clientUuids:n.clientUuids});break;case"set-app-state":this.kosyApp.onProvideState(n.state);break;case"receive-message":this.kosyApp.onReceiveMessage(n.payload)}})),this._sendMessageToKosy({type:"ready-and-listening"})}))}stopApp(){this._sendMessageToKosy({type:"stop-app"})}relayMessage(e){this._sendMessageToKosy({type:"relay-message",payload:e})}_sendMessageToKosy(e){this.kosyClient.postMessage(e,"*")}}const L={"What is love?":["Baby don't hurt me","Don't hurt me","No more"],"Flip flop?":["Flip","Flop"],"What is Kosy?":["Life","Love","Lies!"]};function O(e,t,n){const o=e.slice();return o[23]=t[n],o}function j(e,t,n){const o=e.slice();return o[20]=t[n],o}function K(t){let n;return{c(){n=d("p")},m(e,t){c(e,n,t)},p:e,d(e){e&&l(n)}}}function P(e){let t,n,o,s,r,i=e[0].currentQuestion+"";function u(e,t){return e[0].alreadyAskedQuestions[e[0].currentQuestion]&&e[0].alreadyAskedQuestions[e[0].currentQuestion][e[3]]?B:H}let y=u(e),g=y(e),$=e[2]==e[3]&&D(e);return{c(){t=d("h1"),n=p(i),o=f(),g.c(),s=f(),$&&$.c(),r=h()},m(e,i){c(e,t,i),a(t,n),c(e,o,i),g.m(e,i),c(e,s,i),$&&$.m(e,i),c(e,r,i)},p(e,t){1&t&&i!==(i=e[0].currentQuestion+"")&&m(n,i),y===(y=u(e))&&g?g.p(e,t):(g.d(1),g=y(e),g&&(g.c(),g.m(s.parentNode,s))),e[2]==e[3]?$?$.p(e,t):($=D(e),$.c(),$.m(r.parentNode,r)):$&&($.d(1),$=null)},d(e){e&&l(t),e&&l(o),g.d(e),e&&l(s),$&&$.d(e),e&&l(r)}}}function H(e){let t,n,o,s=e[4],r=[];for(let t=0;t<s.length;t+=1)r[t]=R(O(e,s,t));return{c(){t=d("h3"),t.textContent="Pick an answer:",n=f();for(let e=0;e<r.length;e+=1)r[e].c();o=h()},m(e,s){c(e,t,s),c(e,n,s);for(let t=0;t<r.length;t+=1)r[t].m(e,s);c(e,o,s)},p(e,t){if(144&t){let n;for(s=e[4],n=0;n<s.length;n+=1){const i=O(e,s,n);r[n]?r[n].p(i,t):(r[n]=R(i),r[n].c(),r[n].m(o.parentNode,o))}for(;n<r.length;n+=1)r[n].d(1);r.length=s.length}},d(e){e&&l(t),e&&l(n),u(r,e),e&&l(o)}}}function B(e){let t,n,o,s,r,i,y,g=e[0].alreadyAskedQuestions[e[0].currentQuestion][e[3]]+"",$=e[1],k=[];for(let t=0;t<$.length;t+=1)k[t]=W(j(e,$,t));return{c(){t=d("p"),n=p("Your answer: "),o=p(g),s=f(),r=d("hr"),i=f();for(let e=0;e<k.length;e+=1)k[e].c();y=h()},m(e,l){c(e,t,l),a(t,n),a(t,o),c(e,s,l),c(e,r,l),c(e,i,l);for(let t=0;t<k.length;t+=1)k[t].m(e,l);c(e,y,l)},p(e,t){if(9&t&&g!==(g=e[0].alreadyAskedQuestions[e[0].currentQuestion][e[3]]+"")&&m(o,g),11&t){let n;for($=e[1],n=0;n<$.length;n+=1){const o=j(e,$,n);k[n]?k[n].p(o,t):(k[n]=W(o),k[n].c(),k[n].m(y.parentNode,y))}for(;n<k.length;n+=1)k[n].d(1);k.length=$.length}},d(e){e&&l(t),e&&l(s),e&&l(r),e&&l(i),u(k,e),e&&l(y)}}}function R(e){let t,n,o,s,r=e[23]+"";function i(){return e[9](e[23])}return{c(){t=d("button"),n=p(r)},m(e,r){c(e,t,r),a(t,n),o||(s=y(t,"click",i),o=!0)},p(t,o){e=t,16&o&&r!==(r=e[23]+"")&&m(n,r)},d(e){e&&l(t),o=!1,s()}}}function F(e){let t;function n(e,t){return e[0].alreadyAskedQuestions[e[0].currentQuestion][e[20].clientUuid]?J:z}let o=n(e),s=o(e);return{c(){s.c(),t=h()},m(e,n){s.m(e,n),c(e,t,n)},p(e,r){o===(o=n(e))&&s?s.p(e,r):(s.d(1),s=o(e),s&&(s.c(),s.m(t.parentNode,t)))},d(e){s.d(e),e&&l(t)}}}function z(e){let t,n,o,s=e[20].clientName+"";return{c(){t=d("p"),n=p(s),o=p(" hasn't answered yet.")},m(e,s){c(e,t,s),a(t,n),a(t,o)},p(e,t){2&t&&s!==(s=e[20].clientName+"")&&m(n,s)},d(e){e&&l(t)}}}function J(e){let t,n,o,s,r=e[20].clientName+"",i=e[0].alreadyAskedQuestions[e[0].currentQuestion][e[20].clientUuid]+"";return{c(){t=d("p"),n=p(r),o=p(" answered: "),s=p(i)},m(e,r){c(e,t,r),a(t,n),a(t,o),a(t,s)},p(e,t){2&t&&r!==(r=e[20].clientName+"")&&m(n,r),3&t&&i!==(i=e[0].alreadyAskedQuestions[e[0].currentQuestion][e[20].clientUuid]+"")&&m(s,i)},d(e){e&&l(t)}}}function W(e){let t,n=e[20].clientUuid!==e[3]&&F(e);return{c(){n&&n.c(),t=h()},m(e,o){n&&n.m(e,o),c(e,t,o)},p(e,o){e[20].clientUuid!==e[3]?n?n.p(e,o):(n=F(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&l(t)}}}function D(e){let t,n,o;function s(e,t){return 0===e[5].length?Y:I}let r=s(e),i=r(e);return{c(){t=d("hr"),n=f(),i.c(),o=h()},m(e,s){c(e,t,s),c(e,n,s),i.m(e,s),c(e,o,s)},p(e,t){r===(r=s(e))&&i?i.p(e,t):(i.d(1),i=r(e),i&&(i.c(),i.m(o.parentNode,o)))},d(e){e&&l(t),e&&l(n),i.d(e),e&&l(o)}}}function I(t){let n,o,s;return{c(){n=d("button"),n.textContent="Next question"},m(e,r){c(e,n,r),o||(s=y(n,"click",t[10]),o=!0)},p:e,d(e){e&&l(n),o=!1,s()}}}function Y(t){let n;return{c(){n=d("p"),n.textContent="There are no more questions"},m(e,t){c(e,n,t)},p:e,d(e){e&&l(n)}}}function G(t){let n;function o(e,t){return e[0].currentQuestion&&e[2]&&e[3]?P:K}let s=o(t),r=s(t);return{c(){r.c(),n=h()},m(e,t){r.m(e,t),c(e,n,t)},p(e,[t]){s===(s=o(e))&&r?r.p(e,t):(r.d(1),r=s(e),r&&(r.c(),r.m(n.parentNode,n)))},i:e,o:e,d(e){r.d(e),e&&l(n)}}}function V(e,t,n){let o,s;var r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((o=o.apply(e,t||[])).next())}))};let i,a,c={alreadyAskedQuestions:{},currentQuestion:void 0},l={},u=[];const d=[];for(const e in L)d.push(e);let p=(e,t,o)=>{c.alreadyAskedQuestions[e]||n(0,c.alreadyAskedQuestions[e]={},c),n(0,c.alreadyAskedQuestions[e][t]=o,c)},f=()=>{let e=s[Math.floor(Math.random()*s.length)];n(0,c={alreadyAskedQuestions:Object.assign(Object.assign({},c.alreadyAskedQuestions),{nextQuestion:{}}),currentQuestion:c.currentQuestion}),h.relayMessage({type:"question-asked",payload:e})};const h=new T({onClientHasJoined:e=>(e=>{n(8,l[e.clientUuid]=e,l)})(e),onClientHasLeft:e=>(e=>{delete l[e]})(e),onReceiveMessage:e=>{(e=>{r(void 0,void 0,void 0,(function*(){switch(console.log("Received a message from Kosy: ",e),e.type){case"question-asked":n(0,c={alreadyAskedQuestions:Object.assign(Object.assign({},c.alreadyAskedQuestions),{[e.payload]:{}}),currentQuestion:e.payload});break;case"question-answered":p(c.currentQuestion,e.payload.answeredByClientUuid,e.payload.answer)}}))})(e)},onRequestState:()=>c,onProvideState:e=>(e=>{n(0,c=null!=e?e:c)})(e)});h.startApp().then((e=>{n(2,i=e.initializerClientUuid),n(3,a=e.currentClientUuid),n(8,l=e.clients),e.currentAppState&&n(0,c=e.currentAppState),e.initializerClientUuid==e.currentClientUuid&&f()}));let y=e=>{p(c.currentQuestion,a,e),h.relayMessage({type:"question-answered",payload:{question:c.currentQuestion,answeredByClientUuid:a,answer:e}})};return e.$$.update=()=>{if(258&e.$$.dirty){n(1,u=[]);for(const e in l)if(Object.prototype.hasOwnProperty.call(l,e)){const t=l[e];u.push(t)}u.sort(((e,t)=>e.clientName.localeCompare(t.clientName)))}1&e.$$.dirty&&n(4,o=L[c.currentQuestion]),1&e.$$.dirty&&n(5,s=d.filter((e=>!c.alreadyAskedQuestions[e])))},[c,u,i,a,o,s,f,y,l,e=>y(e),()=>f()]}new class extends class{$destroy(){E(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!i(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}{constructor(e){super(),S(this,e,V,G,r,{})}}({target:document.getElementById("container"),props:{}})})()})();